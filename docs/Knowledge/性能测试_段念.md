软件性能的层面
==============

## 用户视角
- __响应时间__：服务端响应（开始操作到所有数据返回完成的整个耗时[客观]）+ 呈现时间（优化数据呈现策略[主观]）

## 管理员视角
- __资源利用率__：服务器资源（应用服务器、数据库服务器）状况合理吗？
- __系统可扩展性__：是否要扩展、系统性能瓶颈在哪里？更换哪些设备能够提高系统性能？
- __系统容量__：最多能支持多少用户访问？系统最大业务处理量是多少？
- __系统稳定性__：系统能否支持7*24小时的业务访问

## 开发人员视角
- __系统架构__：架构设计是否合理
- __数据库设计__：是否存在问题
- __代码与设计__：内存使用方式、线程同步方式、资源竞争

## Web前端性能
- 浏览器页面加载、HTML解析、图片与css加载、js加载与执行




软件性能术语
============

## 响应时间
- 对请求做出响应的时间，又分用户响应时间、服务器响应时间、前端响应时间

## 并发用户数
- 从业务角度模拟真实的用户访问，体现的是业务并发用户数
- 从服务端承受的压力出发，描述同时向服务端发出请求的客户

> 估算并发用户数`C=nL/T、C^=C+3√C`<br/>
  日志分析工具 AWStats

## 吞吐量
- 直接体现软件系统的性能承载能力，指单位时间内系统处理的客户请求的数量
- 一般用__请求数/秒、页面数/秒、字节数/秒__来衡量，业务系统也可用__业务数/小时__来衡量
- 协助设计性能测试场景，以及衡量性能测试场景是否达到了预期的设计目标
- 协助分析性能瓶颈，有针对性的对吞吐量设计测试，有助于尽快定位到性能瓶颈所在位置

> 以字节数/秒方式表示的吞吐量主要受网络基础设施、服务器架构、应该服务器的制约<br/>
  以单击数/秒方式表示的吞吐量主要受服务器和应用代码的制约

- 没性能瓶颈时`F=VU*R/T`(VU为虚拟用户个数，R表示每个虚拟用户发出请求，T性能测试所用时间)
- 分析吞吐量的图形__吞吐量-VU数__关联图

## 性能计数器
- 描述服务器或操作系统性能的一些数据指标
- 资源利用率，结合响应时间、系统负载曲线等指标进行分析

## 思考时间
- 从业务角度说，指用户在进行操作时，每个请求之间的__间隔时间__

> 计算出系统的并发用户数`C=nL/T、F=R*C`<br/>
  统计出系统的吞吐量`F=VU*R/T、R×C=VU*R/T`<br/>
  统计出平均每用户发出的请求数量`R=u*C*T/VU`<br/>
  根据`R=T/Ts`公式（R表示每个VU发出请求，T性能测试所用时间，Ts为用户思考时间）计算出思考时间`TS=T/R`

- 0思考时间，非交互式应用的性能测试中会用到，研究系统在巨大压力下表现




软件性能测试方法论
==================

## SEI负载测试计划过程
> 关注6个区域：目标、用户、用例、生产环境、测试环境、测试场景

- 生产环境与测试环境的不同，须仔细设计测试环境
- 用户分析，通过对用户行为分析，依据用户行为模型建立用例和场景
- 用例，用户使用某种顺序和操作方式对业务过程进行实现的过程，主要分析和分解出关键的业务，判断每个业务发生的频度、业务出现性能问题的风险

## RBI方法
> Rapid Bottleneck Identify<br/>
  80%系统性能瓶颈由吞吐量制约<br/>
  并发用户数和吞吐量瓶颈之间存在一定的关联<br/>
  采用吞吐量测试可以更快速地定位问题

## 性能下降曲线分析法
> 性能描述随用户数增加而出现下降趋势的曲线，分单用户区域、性能平坦区、压力区域、拐点

## LoadRunner性能测试过程
> 计划测试、测试设计、创建VU脚本、创建测试场景、运行测试场景、分析结果

## Segue提供的性能测试过程
> 从确定性能基线开始，通过单用户对应用的访问获取性能取值的基线，然后设定可接受的性能目标（响应时间），用不同的并发用户数等重复进行测试。该性能测试方法适合性能调优和优化，通过不断的重复的try-check过程，可以逐一找到可能导致性能瓶颈的地方并进行优化

## 敏捷性能测试
- 在每个迭代目标中包含明确的性能目标
- 建立不同层次的性能测试（端到端的、基于接口的、面向具体函数的）
- 完全或接近完全自动化的性能测试
- 使用测试驱动的方法保证性能与优化性能

## PTGM & APTM
- PTGM(Preformance Testing General Model)
> 测试前期准备、测试工具引入、测试计划、测试设计与开发、测试执行与管理、测试分析

- APTM(Agile Performance Testing Model)
> 检查表、活动、建议工具




性能测试的方法
==============

## 验收性能测试
> 通过模拟生产运行的业务压力量和使用场景组合，测试系统的性能是否满足生产性能要求

- 验证系统__是否具有系统宣称具有的能力__
- 需要事先了解被测试系统的典型场景，并具有确定的性能目标
- 这种方法要求在已确定的环境下运行

## 负载测试
> 在被测系统上不断增加压力，直到性能指标（响应时间）超过预定指标或某种资源使用已达到饱和状态

- 主要目的是找到__系统处理能力的极限__
- 需要在给定的测试环境下进行，通常也需要考虑被测系统的业务压力量和典型场景
- 一般用来了解系统的性能容量，或是配合性能调优来使用

## 压力测试
> 测试系统在一定饱和状态下，如CPU、内存等在饱和使用情况下，系统能够处理的会话能力，以及系统是否会出现错误

- 主要目的是检查__系统处于压力情况下时应用的性能表现__
- 一般通过模拟负载等方法，使得系统的资源使用达到较高水平
- 一般用于测试系统稳定性

## 配置测试
> 通过对被测试系统软硬件环境的调整，了解各种不同环境对系统性能影响的程度，从而找到系统各项资源的最优分配原则

- 主要目的是了解各种__不同因素对系统性能影响的程度__，从而判断出最值得进行的调优操作
- 一般在对系统性能状况有初步了解后再进行
- 一般用于性能调优和规划能力

## 并发测试
> 通过模拟用户的并发访问，测试多用户并发访问同一个应用、同一个模块或者数据记录时是否存在死锁或者其他性能问题

- 主要目的是发现系统中可能__隐藏的并发访问时的问题__
- 主要关注系统中的内在泄露、死锁等问题

> 内存问题：内存泄露、太多临时对象、太多超过设计生命周期对象<br/>
  数据库问题：数据库死锁、长事务<br/>
  线程/进程：同步失败<br/>
  其它：资源争用导致死锁、没正确处理异常导致系统死锁

- 可以在开发的各个阶段使用，需要相关的测试工具配合和支持

## 可靠性测试
> 通过给系统加载一定的业务压力，让应用持续运行一段时间，测试系统在这种条件下能否稳定运行

- 主要目的是验证系统是否__支持长期稳定的运行__
- 需要在压力下持续一段时间的运行
- 测试过程中需要关注系统的运行状况

## 失效恢复测试
> 针对有冗余备份和负载均衡的系统设计的，检查如果系统局部发生故障，用户是否能够继续使用系统

- 主要目的是验证在局部故障情况下，系统能否继续使用
- 需指出当问题发生时“能支持多少用户访问”的结论和“采取何种应急措施”的方案




性能测试应用领域
================

## 能力验证
> 在给定条件下，系统能否具有预期的能力表现<br/>
  采用的测试方法有性能测试、可靠性测试、压力测试和失效恢复测试

- 要求在已确定的环境下运行
- 需要根据典型场景设计测试方案和用例


## 规划能力
> 应该如何使系统具有我们要求的性能能力<br/>
  能否支持未来一段时间内的用户增长，应该如何调整系统配置，使系统能够满足增长的用户数的需要

- 是一种探索性测试，没有预期目标，而是了解系统本身的能力
- 被用于了解系统的性能以及获得扩展性的方法

## 性能调优
> 一种在开发和测试阶段都可能会涉及的

- 确定基准环境、基准负载和基准性能指标，建立“标准的应用运行环境”
- 调整系统运行环境和实现方法（硬件环境、系统设置、应用级别的调整），执行测试
- 记录测试结果，进行分析

## 缺陷发现
> 通过性能测试的手段来发现系统中存在的缺陷

## 性能基准比较
> 通常应用在敏捷开发过程中，保证应用性能不会随着每次迭代的不断发生而变坏

















